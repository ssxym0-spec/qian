# ğŸ“‹ åç«¯ API éœ€æ±‚ï¼šåŠ¨æ€å“ç±»åˆ—è¡¨æ¥å£

## ğŸ¯ éœ€æ±‚èƒŒæ™¯

å½“å‰å‰ç«¯æ‰¹æ¬¡è¿½æº¯é¡µé¢çš„å“ç±»ç­›é€‰å™¨ä½¿ç”¨ç¡¬ç¼–ç çš„å“ç±»åˆ—è¡¨ï¼ˆæ˜å‰èŒ¶ã€é›¨å‰èŒ¶ã€æ˜¥èŒ¶ã€å¤èŒ¶ã€ç§‹èŒ¶ï¼‰ã€‚ä¸ºäº†å®ç°å“ç±»çš„åŠ¨æ€ç®¡ç†ï¼Œéœ€è¦åç«¯æä¾›ä¸€ä¸ªæ¥å£ï¼Œè¿”å›æ‰€æœ‰å­˜åœ¨æ‰¹æ¬¡æ•°æ®çš„å“ç±»åˆ—è¡¨ã€‚

### å½“å‰å®ç°æ–¹å¼ï¼ˆç¡¬ç¼–ç ï¼‰
```typescript
// app/suyuan/components/CategoryFilter.tsx
const CATEGORIES = [
  { name: 'æ˜å‰èŒ¶', slug: 'mingqian' },
  { name: 'é›¨å‰èŒ¶', slug: 'yuqian' },
  { name: 'æ˜¥èŒ¶', slug: 'chuncha' },
  { name: 'å¤èŒ¶', slug: 'xiacha' },
  { name: 'ç§‹èŒ¶', slug: 'qiucha' },
];
```

### ç›®æ ‡å®ç°æ–¹å¼ï¼ˆåŠ¨æ€è·å–ï¼‰
ä»åç«¯ API åŠ¨æ€è·å–æ‰€æœ‰å­˜åœ¨æ‰¹æ¬¡çš„å“ç±»ï¼Œè‡ªåŠ¨ç”Ÿæˆå“ç±»æ ‡ç­¾é¡µã€‚

---

## ğŸ”Œ æ¥å£è§„æ ¼

### 1ï¸âƒ£ è·å–å“ç±»åˆ—è¡¨æ¥å£ï¼ˆæ¨èæ–¹æ¡ˆï¼‰

#### åŸºæœ¬ä¿¡æ¯
æ–¹æ³•: GET
è·¯å¾„: /api/public/categories
è®¤è¯: æ— éœ€è®¤è¯ï¼ˆå…¬å¼€æ¥å£ï¼‰
#### è¯·æ±‚å‚æ•°
æ— éœ€å‚æ•°

#### åŠŸèƒ½è¯´æ˜
- è¿”å›æ•°æ®åº“ä¸­æ‰€æœ‰å­˜åœ¨æ‰¹æ¬¡æ•°æ®çš„**å”¯ä¸€å“ç±»**åˆ—è¡¨
- åªè¿”å›è‡³å°‘æœ‰ä¸€ä¸ªæ‰¹æ¬¡çš„å“ç±»ï¼ˆé¿å…ç©ºå“ç±»ï¼‰
- æŒ‰å“ç±»çš„æŸç§é¡ºåºæ’åºï¼ˆå»ºè®®ï¼šæŒ‰å“ç±»é¦–æ¬¡åˆ›å»ºæ—¶é—´ã€æˆ–æŒ‰æ‹¼éŸ³æ’åºï¼‰

#### å“åº”æ ¼å¼

**æ–¹æ¡ˆ Aï¼šç®€å•æ•°ç»„ï¼ˆæ¨èï¼‰**
```json
[
  {
    "name": "æ˜å‰èŒ¶",
    "count": 12
  },
  {
    "name": "é›¨å‰èŒ¶",
    "count": 8
  },
  {
    "name": "æ˜¥èŒ¶",
    "count": 15
  },
  {
    "name": "å¤èŒ¶",
    "count": 5
  },
  {
    "name": "ç§‹èŒ¶",
    "count": 3
  }
]
```

**æ–¹æ¡ˆ Bï¼šåŒ…è£…æ ¼å¼**
```json
{
  "success": true,
  "data": [
    {
      "name": "æ˜å‰èŒ¶",
      "count": 12
    },
    {
      "name": "é›¨å‰èŒ¶",
      "count": 8
    }
  ]
}
```

> ğŸ’¡ **å»ºè®®**ï¼šä½¿ç”¨æ–¹æ¡ˆ Aï¼ˆç®€å•æ•°ç»„ï¼‰ï¼Œä¸ç°æœ‰çš„ `/api/public/batches` æ¥å£ä¿æŒä¸€è‡´

#### å­—æ®µè¯´æ˜

| å­—æ®µå | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|--------|------|------|------|
| `name` | string | æ˜¯ | å“ç±»ä¸­æ–‡åç§°ï¼ˆå¦‚ï¼šæ˜å‰èŒ¶ã€é›¨å‰èŒ¶ç­‰ï¼‰ |
| `count` | number | å¦ | è¯¥å“ç±»ä¸‹çš„æ‰¹æ¬¡æ•°é‡ï¼ˆå¯é€‰ï¼Œç”¨äºå‰ç«¯æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯ï¼‰ |

#### å®ç°å»ºè®®ï¼ˆMongoDB èšåˆæŸ¥è¯¢ï¼‰

```javascript
// routes/public.js æˆ– controllers/categoryController.js

router.get('/api/public/categories', async (req, res) => {
  try {
    // ä½¿ç”¨èšåˆç®¡é“è·å–å”¯ä¸€å“ç±»åŠå…¶æ‰¹æ¬¡æ•°é‡
    const categories = await Batch.aggregate([
      {
        // æŒ‰å“ç±»å­—æ®µåˆ†ç»„
        $group: {
          _id: '$category_name',  // ç¡®ä¿å­—æ®µåä¸ Batch æ¨¡å‹ä¸€è‡´
          count: { $sum: 1 }      // ç»Ÿè®¡æ¯ä¸ªå“ç±»çš„æ‰¹æ¬¡æ•°é‡
        }
      },
      {
        // é‡å¡‘è¾“å‡ºæ ¼å¼
        $project: {
          _id: 0,
          name: '$_id',
          count: 1
        }
      },
      {
        // æŒ‰å“ç±»åç§°æ’åºï¼ˆå¯é€‰ï¼šæŒ‰æ‹¼éŸ³æˆ–é¦–å­—æ¯ï¼‰
        $sort: { name: 1 }
      }
    ]);

    // è¿”å›å“ç±»æ•°ç»„
    res.json(categories);
    
  } catch (error) {
    console.error('Error fetching categories:', error);
    res.status(500).json({
      success: false,
      message: 'è·å–å“ç±»åˆ—è¡¨å¤±è´¥'
    });
  }
});
```

#### é”™è¯¯å¤„ç†

```json
// HTTP 500 - æœåŠ¡å™¨å†…éƒ¨é”™è¯¯
{
  "success": false,
  "message": "è·å–å“ç±»åˆ—è¡¨å¤±è´¥"
}
```

---

### 2ï¸âƒ£ æ”¹é€ ç°æœ‰æ‰¹æ¬¡æ¥å£ï¼ˆå¤‡é€‰æ–¹æ¡ˆï¼‰

å¦‚æœä¸æƒ³æ–°å¢æ¥å£ï¼Œå¯ä»¥æ”¹é€ ç°æœ‰çš„æ‰¹æ¬¡åˆ—è¡¨æ¥å£ï¼š

#### ä¿®æ”¹å†…å®¹
GET /api/public/batches
å½“ **ä¸ä¼ ** `category` å‚æ•°æ—¶ï¼Œè¿”å›æ‰€æœ‰å“ç±»çš„æ‰€æœ‰æ‰¹æ¬¡ï¼š

```javascript
// æ”¹é€ å‰
GET /api/public/batches?category=æ˜å‰èŒ¶  // åªè¿”å›æ˜å‰èŒ¶æ‰¹æ¬¡

// æ”¹é€ å
GET /api/public/batches                  // è¿”å›æ‰€æœ‰æ‰¹æ¬¡ï¼ˆæ–°å¢ï¼‰
GET /api/public/batches?category=æ˜å‰èŒ¶  // è¿”å›æ˜å‰èŒ¶æ‰¹æ¬¡ï¼ˆä¿æŒä¸å˜ï¼‰
```

#### å‰ç«¯å¤„ç†æ–¹å¼
å‰ç«¯å¯ä»¥ä»æ‰€æœ‰æ‰¹æ¬¡ä¸­æå–å”¯ä¸€å“ç±»ï¼š

```typescript
const response = await fetch('/api/public/batches');
const allBatches = await response.json();

// æå–å”¯ä¸€å“ç±»
const uniqueCategories = [...new Set(allBatches.map(b => b.category_name))];
```

> âš ï¸ **æ³¨æ„**ï¼šæ­¤æ–¹æ¡ˆä¼šè¿”å›æ‰€æœ‰æ‰¹æ¬¡æ•°æ®ï¼Œæ•°æ®é‡è¾ƒå¤§æ—¶å¯èƒ½å½±å“æ€§èƒ½ï¼Œå»ºè®®ä½¿ç”¨æ–¹æ¡ˆ 1

---

## ğŸ“Š æ•°æ®ä¸€è‡´æ€§è¦æ±‚

### âš ï¸ é‡è¦ï¼šå“ç±»å­—æ®µåç§°ç»Ÿä¸€

è¯·ç¡®è®¤åç«¯ Batch æ¨¡å‹ä¸­å“ç±»å­—æ®µåç§°ï¼š
- âœ… **æ¨è**ï¼š`category_name`ï¼ˆä¸ç°æœ‰ `/api/public/batches` æ¥å£ä¿æŒä¸€è‡´ï¼‰
- âŒ **é¿å…**ï¼š`category`ã€`type`ã€`tea_category` ç­‰å…¶ä»–å‘½å

### å½“å‰æ‰¹æ¬¡æ¥å£è¿”å›çš„å­—æ®µï¼ˆä¾›å‚è€ƒï¼‰

```json
// GET /api/public/batches?category=æ˜å‰èŒ¶
[
  {
    "_id": "673abc123def456789012345",
    "batch_number": "MQ-20250328-01",
    "category_name": "æ˜å‰èŒ¶",  // â† è¯·ç¡®ä¿æ–°æ¥å£ä½¿ç”¨ç›¸åŒçš„å­—æ®µå
    "grade_id": {
      "_id": "grade001",
      "name": "è‡»å“",
      "badge_url": "/uploads/badges/zhenpin.png"
    },
    "title": "å¹´åº¦è‡³è‡» é™å€™æ˜¥é›·",
    "summary": "ç”±3æœˆ25æ—¥è‡³28æ—¥ï¼Œå››æ—¥æ™¨éœ²ä¹‹ç²¾åæ±‡èš",
    "cover_image_url": "/uploads/batches/cover.jpg",
    // ... å…¶ä»–å­—æ®µ
  }
]
```

---

## ğŸ”„ å‰ç«¯ä½¿ç”¨åœºæ™¯

### åœºæ™¯ 1ï¼šåŠ¨æ€æ¸²æŸ“å“ç±»æ ‡ç­¾
å‰ç«¯ä¼šè°ƒç”¨æ­¤æ¥å£ï¼Œç„¶åä¸ºæ¯ä¸ªå“ç±»ç”Ÿæˆä¸€ä¸ªå¯ç‚¹å‡»çš„æ ‡ç­¾ï¼š
ç”¨æˆ·çœ‹åˆ°ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ˜å‰èŒ¶ â”‚ é›¨å‰èŒ¶ â”‚ æ˜¥èŒ¶ â”‚ å¤èŒ¶ â”‚ ç§‹èŒ¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â†“ â†“ â†“ â†“ â†“
/suyuan/mingqian /suyuan/yuqian /suyuan/chuncha ...

### åœºæ™¯ 2ï¼šéªŒè¯è·¯ç”±å‚æ•°
å½“ç”¨æˆ·è®¿é—® `/suyuan/mingqian` æ—¶ï¼Œå‰ç«¯ä¼šï¼š
1. è°ƒç”¨ `/api/public/categories` è·å–å¯ç”¨å“ç±»åˆ—è¡¨
2. æ£€æŸ¥ `mingqian` å¯¹åº”çš„ `æ˜å‰èŒ¶` æ˜¯å¦åœ¨åˆ—è¡¨ä¸­
3. å¦‚æœä¸å­˜åœ¨ï¼Œæ˜¾ç¤º 404 é¡µé¢

### åœºæ™¯ 3ï¼šè‡ªåŠ¨é€‚åº”æ–°å“ç±»
- åç«¯æ–°å¢ä¸€ä¸ªå“ç±»ï¼ˆå¦‚"å†¬èŒ¶"ï¼‰å¹¶åˆ›å»ºæ‰¹æ¬¡
- å‰ç«¯æ— éœ€ä¿®æ”¹ä»£ç ï¼Œè‡ªåŠ¨æ˜¾ç¤º"å†¬èŒ¶"æ ‡ç­¾
- ç”¨æˆ·å¯ä»¥ç›´æ¥æµè§ˆå†¬èŒ¶æ‰¹æ¬¡

---

## ğŸ“ å‰ç«¯å®ç°ç¤ºä¾‹ï¼ˆä¾›å‚è€ƒï¼‰

### å‰ç«¯è°ƒç”¨ä»£ç 

```typescript
// app/suyuan/utils/categoryUtils.ts
export async function getAvailableCategories() {
  try {
    const response = await fetch('http://localhost:3000/api/public/categories', {
      cache: 'no-store',
    });
    
    if (!response.ok) {
      console.error('Failed to fetch categories');
      return [];
    }
    
    const categories = await response.json();
    
    // è½¬æ¢ä¸ºå‰ç«¯éœ€è¦çš„æ ¼å¼ï¼ˆæ·»åŠ  slugï¼‰
    return categories.map(cat => ({
      name: cat.name,
      slug: getCategorySlug(cat.name),
      count: cat.count
    }));
  } catch (error) {
    console.error('Error fetching categories:', error);
    return [];
  }
}

// ä¸­æ–‡åç§°è½¬ URL slug
function getCategorySlug(categoryName: string): string {
  const slugMap: Record<string, string> = {
    'æ˜å‰èŒ¶': 'mingqian',
    'é›¨å‰èŒ¶': 'yuqian',
    'æ˜¥èŒ¶': 'chuncha',
    'å¤èŒ¶': 'xiacha',
    'ç§‹èŒ¶': 'qiucha',
    // å¯æ‰©å±•...
  };
  return slugMap[categoryName] || categoryName.toLowerCase();
}
```

---

## âœ… éªŒæ”¶æ ‡å‡†

è¯·ç¡®ä¿å®ç°æ»¡è¶³ä»¥ä¸‹è¦æ±‚ï¼š

- [ ] æ¥å£èƒ½å¤Ÿæ­£ç¡®è¿”å›æ‰€æœ‰å­˜åœ¨æ‰¹æ¬¡çš„å“ç±»
- [ ] åªè¿”å›è‡³å°‘æœ‰ä¸€ä¸ªæ‰¹æ¬¡çš„å“ç±»ï¼ˆæ— ç©ºå“ç±»ï¼‰
- [ ] å“ç±»åç§°å­—æ®µä¸º `name`ï¼Œä¸ Batch æ¨¡å‹çš„ `category_name` å­—æ®µä¿æŒä¸€è‡´
- [ ] å“åº”æ ¼å¼ä¸º JSON æ•°ç»„ï¼ˆæ¨èï¼‰æˆ–æ ‡å‡†åŒ…è£…æ ¼å¼
- [ ] æ¥å£å“åº”æ—¶é—´ < 500ms
- [ ] æ”¯æŒ CORSï¼ˆå¦‚å‰åç«¯åˆ†ç¦»éƒ¨ç½²ï¼‰
- [ ] æ¥å£å·²åœ¨ Postman/curl ä¸­æµ‹è¯•é€šè¿‡

---

## ğŸ§ª æµ‹è¯•æ–¹æ³•

### ä½¿ç”¨ curl æµ‹è¯•

```bash
# æµ‹è¯•å“ç±»æ¥å£
curl http://localhost:3000/api/public/categories

# æœŸæœ›å“åº”ï¼ˆç¤ºä¾‹ï¼‰
[
  {"name": "æ˜å‰èŒ¶", "count": 12},
  {"name": "é›¨å‰èŒ¶", "count": 8},
  {"name": "æ˜¥èŒ¶", "count": 15}
]
```

### ä½¿ç”¨ Postman æµ‹è¯•
æ–¹æ³•: GET
URL: http://localhost:3000/api/public/categories
Headers: (æ— éœ€ç‰¹æ®Š headers)

### æµ‹è¯•ç”¨ä¾‹

| åœºæ™¯ | é¢„æœŸç»“æœ |
|------|---------|
| æ•°æ®åº“æœ‰ 3 ä¸ªå“ç±»çš„æ‰¹æ¬¡ | è¿”å› 3 ä¸ªå“ç±» |
| æŸä¸ªå“ç±»æ²¡æœ‰æ‰¹æ¬¡ | ä¸è¿”å›è¯¥å“ç±» |
| æ•°æ®åº“ä¸ºç©º | è¿”å›ç©ºæ•°ç»„ `[]` |
| æœåŠ¡å™¨é”™è¯¯ | è¿”å› 500 é”™è¯¯å’Œé”™è¯¯ä¿¡æ¯ |

---

## ğŸš€ å¼€å‘ä¼˜å…ˆçº§

- **ä¼˜å…ˆçº§**ï¼šä¸­ç­‰
- **é¢„è®¡å·¥ä½œé‡**ï¼š0.5 - 1 å°æ—¶ï¼ˆä½¿ç”¨èšåˆæŸ¥è¯¢ï¼‰
- **å‰ç«¯ä¾èµ–**ï¼šç­‰æ­¤æ¥å£å®Œæˆåï¼Œå‰ç«¯å°†ç§»é™¤ç¡¬ç¼–ç å“ç±»å¹¶å®ç°åŠ¨æ€åŠ è½½
- **å»ºè®®å®Œæˆæ—¶é—´**ï¼šæœ¬å‘¨å†…

---

## ğŸ“ æ²Ÿé€šä¸åä½œ

### å¦‚æœ‰ç–‘é—®ï¼Œè¯·è”ç³»å‰ç«¯å¼€å‘

- **æ¥å£è¿”å›æ ¼å¼æœ‰ç–‘é—®ï¼Ÿ** â†’ æˆ‘ä»¬å¯ä»¥è°ƒæ•´å‰ç«¯é€‚é…é€»è¾‘
- **å­—æ®µåç§°ä¸ç¡®å®šï¼Ÿ** â†’ è¯·å‘ŠçŸ¥å½“å‰ Batch æ¨¡å‹çš„å“ç±»å­—æ®µå
- **éœ€è¦å…¶ä»–å­—æ®µï¼Ÿ** â†’ è¯·è¯´æ˜éœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥è®¨è®º
- **æ€§èƒ½è€ƒè™‘ï¼Ÿ** â†’ å¯ä»¥æ·»åŠ ç¼“å­˜æˆ–ç´¢å¼•ä¼˜åŒ–

### åä½œå»ºè®®

1. åç«¯å®ç°æ¥å£åï¼Œè¯·æä¾›æµ‹è¯•ç¯å¢ƒ URL
2. å‰ç«¯ä¼šå…ˆåœ¨å¼€å‘ç¯å¢ƒæµ‹è¯•é›†æˆ
3. ç¡®è®¤æ— è¯¯åï¼ŒåŒæ–¹åŒæ­¥éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **æ‰¹æ¬¡è¿½æº¯é¡µå¿«é€Ÿå‚è€ƒ**ï¼š`BATCH_TRACING_PAGE_QUICKSTART.md`
- **æ‰¹æ¬¡ç±»å‹å®šä¹‰**ï¼š`app/suyuan/types.ts`
- **å½“å‰æ‰¹æ¬¡åˆ—è¡¨é¡µé¢**ï¼š`app/suyuan/[category]/page.tsx`
- **å“ç±»ç­›é€‰å™¨ç»„ä»¶**ï¼š`app/suyuan/components/CategoryFilter.tsx`

---

## ğŸ”„ åç»­æ‰©å±•è®¡åˆ’

æ¥å£ä¸Šçº¿åï¼Œå¯è€ƒè™‘ä»¥ä¸‹æ‰©å±•ï¼š

1. **å“ç±»æ’åº**ï¼šæ”¯æŒè‡ªå®šä¹‰å“ç±»æ˜¾ç¤ºé¡ºåº
2. **å“ç±»å›¾æ ‡**ï¼šä¸ºæ¯ä¸ªå“ç±»æ·»åŠ å›¾æ ‡å­—æ®µ
3. **å“ç±»æè¿°**ï¼šæ·»åŠ å“ç±»çš„ç®€çŸ­æè¿°
4. **å“ç±»å¯ç”¨çŠ¶æ€**ï¼šæ”¯æŒæš‚æ—¶éšè—æŸäº›å“ç±»

---

**éœ€æ±‚æå‡ºæ—¶é—´**ï¼š2025å¹´10æœˆ7æ—¥  
**éœ€æ±‚ç‰ˆæœ¬**ï¼šv1.0  
**æ–‡æ¡£ç»´æŠ¤è€…**ï¼šå‰ç«¯å¼€å‘å›¢é˜Ÿ

---

## é™„å½•ï¼šå®Œæ•´å®ç°ç¤ºä¾‹

### Node.js + Express + MongoDB å®Œæ•´ä»£ç 

```javascript
// routes/public.js
const express = require('express');
const router = express.Router();
const Batch = require('../models/Batch');

/**
 * è·å–æ‰€æœ‰å¯ç”¨çš„å“ç±»åˆ—è¡¨
 * GET /api/public/categories
 */
router.get('/api/public/categories', async (req, res) => {
  try {
    console.log('ğŸ“‹ [API] è·å–å“ç±»åˆ—è¡¨è¯·æ±‚');

    // ä½¿ç”¨èšåˆç®¡é“è·å–å”¯ä¸€å“ç±»
    const categories = await Batch.aggregate([
      {
        $group: {
          _id: '$category_name',
          count: { $sum: 1 }
        }
      },
      {
        $project: {
          _id: 0,
          name: '$_id',
          count: 1
        }
      },
      {
        $sort: { name: 1 }
      }
    ]);

    console.log(`âœ… [API] æˆåŠŸè·å– ${categories.length} ä¸ªå“ç±»`);
    res.json(categories);

  } catch (error) {
    console.error('âŒ [API] è·å–å“ç±»åˆ—è¡¨å¤±è´¥:', error);
    res.status(500).json({
      success: false,
      message: 'è·å–å“ç±»åˆ—è¡¨å¤±è´¥',
      error: process.env.NODE_ENV === 'development' ? error.message : undefined
    });
  }
});

module.exports = router;
```

### æ·»åŠ ç¼“å­˜ä¼˜åŒ–ï¼ˆå¯é€‰ï¼‰

```javascript
const NodeCache = require('node-cache');
const categoryCache = new NodeCache({ stdTTL: 600 }); // ç¼“å­˜ 10 åˆ†é’Ÿ

router.get('/api/public/categories', async (req, res) => {
  try {
    // æ£€æŸ¥ç¼“å­˜
    const cached = categoryCache.get('categories');
    if (cached) {
      console.log('ğŸ“¦ [API] è¿”å›ç¼“å­˜çš„å“ç±»åˆ—è¡¨');
      return res.json(cached);
    }

    // æŸ¥è¯¢æ•°æ®åº“
    const categories = await Batch.aggregate([
      { $group: { _id: '$category_name', count: { $sum: 1 } } },
      { $project: { _id: 0, name: '$_id', count: 1 } },
      { $sort: { name: 1 } }
    ]);

    // å­˜å…¥ç¼“å­˜
    categoryCache.set('categories', categories);
    
    res.json(categories);
  } catch (error) {
    console.error('âŒ [API] è·å–å“ç±»åˆ—è¡¨å¤±è´¥:', error);
    res.status(500).json({
      success: false,
      message: 'è·å–å“ç±»åˆ—è¡¨å¤±è´¥'
    });
  }
});
```

---

**ç¥å¼€å‘é¡ºåˆ©ï¼** ğŸ‰